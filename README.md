# Mediator
Simple mediator implementation in Go.

## Installation
```bash
go get github.com/oli4maes/mediator
```

## Usage
An example of how to use the request/response pattern with the appropriate request handler.
These files can be generated by [mediator-tools](https://github.com/oli4maes/mediator-tools).
A very simple example of how this pattern is used can be found on [sipsavy](https://github.com/oli4maes/sipsavy).

### Request

```go
package createproduct

// Request - Create Product 
type Request struct {
	Name        string
	Description string
}
```

### Response

```go
package createproduct

// Response - Create Product
type Response struct {
	ProductID   uuid.UUID
	Name        string
	Description string
}
```

### Request Handler
```go
package createproduct

// Register createProductHandler
func init() {
    repo := NewProductRepo()

    err := mediator.Register[Request, Response](handler{repo: repo})
    if err != nil {
        panic (err)
    }
}

// handler is the mediator handler, all dependencies should be added here
type handler struct {
    repo ProductRepo
}

func (h handler) Handle(ctx context.Context, request Request) (Response, error) {
    product := Product {
        ProductID:   uuid.New(),
        Name:        request.Name,
        Description: request.Description,
    }
    
    createdProduct, err := h.repo.Create(ctx, product)
    if err != nil {
        return  Response{}, err
    }
    
    return Response {
            ProductID:   createdProduct.ProductID,
            Name:        createdProduct.Name,
            Description: createdProduct.Description,
    }, nil   
}

```

### Sending a request
```go
request := createproduct.Request {
	Name: "name",
	Description: "description",
}

response, err := mediator.Send[createproduct.Request, createproduct.Response](ctx, request)
```